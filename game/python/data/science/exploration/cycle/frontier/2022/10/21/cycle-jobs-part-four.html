<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Which Cycle Frontier Jobs Are Worth Doing? - Part Four. | Orgulo.us</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Which Cycle Frontier Jobs Are Worth Doing? - Part Four." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Time To Deal With the Missing Values" />
<meta property="og:description" content="Time To Deal With the Missing Values" />
<link rel="canonical" href="https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html" />
<meta property="og:url" content="https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html" />
<meta property="og:site_name" content="Orgulo.us" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-21T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"Which Cycle Frontier Jobs Are Worth Doing? - Part Four.","dateModified":"2022-10-21T00:00:00-05:00","datePublished":"2022-10-21T00:00:00-05:00","description":"Time To Deal With the Missing Values","mainEntityOfPage":{"@type":"WebPage","@id":"https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html"},"@type":"BlogPosting","url":"https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://orgulo.us/feed.xml" title="Orgulo.us" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Which Cycle Frontier Jobs Are Worth Doing? - Part Four. | Orgulo.us</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Which Cycle Frontier Jobs Are Worth Doing? - Part Four." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Time To Deal With the Missing Values" />
<meta property="og:description" content="Time To Deal With the Missing Values" />
<link rel="canonical" href="https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html" />
<meta property="og:url" content="https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html" />
<meta property="og:site_name" content="Orgulo.us" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-21T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"Which Cycle Frontier Jobs Are Worth Doing? - Part Four.","dateModified":"2022-10-21T00:00:00-05:00","datePublished":"2022-10-21T00:00:00-05:00","description":"Time To Deal With the Missing Values","mainEntityOfPage":{"@type":"WebPage","@id":"https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html"},"@type":"BlogPosting","url":"https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://orgulo.us/feed.xml" title="Orgulo.us" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Orgulo.us</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Readings/">Reading Challenge</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Which Cycle Frontier Jobs Are Worth Doing? - Part Four.</h1><p class="page-description">Time To Deal With the Missing Values</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-21T00:00:00-05:00" itemprop="datePublished">
        Oct 21, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      32 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#game">game</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#data">data</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#science">science</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#exploration">exploration</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#cycle">cycle</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#frontier">frontier</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#Fix-Item-Names">Fix Item Names </a></li>
<li class="toc-entry toc-h2"><a href="#Data-Drives:">Data Drives: </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Add-the-Guns">Add the Guns </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Deal-With-Backpacks">Deal With Backpacks </a></li>
<li class="toc-entry toc-h2"><a href="#Deal-with-Ammo">Deal with Ammo </a></li>
<li class="toc-entry toc-h2"><a href="#Deal-with-The-Heavy-Mining-Tool">Deal with The Heavy Mining Tool </a></li>
<li class="toc-entry toc-h2"><a href="#Conclusions">Conclusions </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-21-cycle-jobs-part-four.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Welcome back to the fourth post in the series. Last time, we were having issues with the data since there were missing values - including the Job that prompted the initial investigation. We'll jump right into it picking up with the mismatch between naming in tables.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While working through the list of problems I found reviewing the data, there is clearly an error in the Regex built before. The symptom of this was the <em>Autoloader</em> which has a hanging number when the group is pulled out.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">siteJobs</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Description"</span><span class="p">,</span> <span class="s2">"Tasks"</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Kill"</span><span class="p">)]</span>

<span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(\d+\s[\w]+\s[\w]+)"</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span>
<span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'Autoloader'</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>1 Autoloader 5</td>
    </tr>
    <tr>
      <th>32</th>
      <th>0</th>
      <td>2 Autoloader 8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After some work, this was because the hanging <code>[\w]+</code> was too greedy and had to be toned down.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newRegex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(\d+\s[\w]+\s?[a-zA-Z]+)"</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">newRegex</span><span class="p">)</span>
<span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'Autoloader'</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>1 Autoloader</td>
    </tr>
    <tr>
      <th>32</th>
      <th>0</th>
      <td>2 Autoloader</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This didn't end up being the only correction to the Regex; in fact, the Co-Tool Multitool was being broken apart since it has a <code>-</code> in the name. So, we had to update this to check and include the <code>-</code> on the split.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newRegex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"((\d+\s[\w\-]+\s?[a-zA-Z]+))"</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll have our updated version of the <code>breakLoot</code> function we write before.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">breakLoot</span><span class="p">(</span><span class="n">taskString</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">taskString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This shouldn't be called.</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">siteJobs</span><span class="p">[</span><span class="n">index</span><span class="p">][[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Description"</span><span class="p">,</span> <span class="s2">"Tasks"</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
    <span class="n">tasksSubset</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Kill"</span><span class="p">)]</span>

    <span class="n">newRegex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"((\d+\s[\w\-]+\s?[a-zA-Z]+))"</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">newRegex</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">breakLoot</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">aLoot</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">breakLoot</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">,</span>
        <span class="n">loot</span> <span class="o">=</span> <span class="n">aLoot</span>
    <span class="p">)</span>

    <span class="n">nameDescriptSlice</span> <span class="o">=</span> <span class="n">tasksSubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">"level_0"</span><span class="p">],</span> <span class="p">[</span><span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">]]</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">nameDescriptSlice</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">nameDescriptSlice</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">values</span>
    <span class="p">)</span>

    <span class="n">taskSlice</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
        <span class="s1">'level_0'</span><span class="p">,</span>
        <span class="s1">'match'</span><span class="p">,</span>
        <span class="mi">0</span>
    <span class="p">],</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">)</span>

    <span class="n">taskSlice</span> <span class="o">=</span> <span class="n">taskSlice</span><span class="p">[[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">]]</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">taskSlice</span><span class="p">)</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="o">*</span><span class="n">tasks</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fix-Item-Names">
<a class="anchor" href="#Fix-Item-Names" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fix Item Names<a class="anchor-link" href="#Fix-Item-Names"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can continue and move to fixing the name mismatches like intended. There was quite a few of these so I'll only show the process for a few of them - and then the fix for all of them. We'll pull the code from the previous post so we can start by using the <code>0</code> values and work backwards.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">allJobs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">korolevRewards</span><span class="p">,</span> <span class="n">icaRewards</span><span class="p">,</span> <span class="n">osirisRewards</span><span class="p">])</span>
<span class="n">lootKMarks</span> <span class="o">=</span> <span class="n">loot</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Name == "K-Marks"'</span><span class="p">)</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">taskLoot</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
<span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span> <span class="o">=</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">*</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">allJobs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Rewards == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">taskLoot</span><span class="p">[[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">'Balance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Units'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span>

<span class="c1"># How many are there?</span>
<span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>30</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are 31 rows with a <code>Cost</code> of <code>0</code> which we'll need to investigate. The first one which I had noticed and corrected in the previous post was the CPU's so we'll address this one first. We'll need to find the values in the <code>tasks</code> table and the <code>lootKMarks</code> table so we can figure out where the disconnect is.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Master|Zero"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Mining Bot</td>
      <td>2</td>
      <td>Zero Systems</td>
      <td>Our engineers have designed an autonomous mini...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Insufficient Processing Power</td>
      <td>1</td>
      <td>Master Unit</td>
      <td>Prospector! The Zero Systems CPU you brought u...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Automated Security</td>
      <td>5</td>
      <td>Zero Systems</td>
      <td>We will have to build new turrets to help prot...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Classified I</td>
      <td>2</td>
      <td>Master Unit</td>
      <td>Prospector! We need Derelict Explosives, Maste...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Upgrades</td>
      <td>1</td>
      <td>Master Unit</td>
      <td>We want to take over an ICA Data Center. Stash...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sabotage</td>
      <td>4</td>
      <td>Zero Systems</td>
      <td>Prospector! Those Korolev simpletons are drill...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Spare Parts</td>
      <td>4</td>
      <td>Zero Systems</td>
      <td>One of the Servers at Starport has been failin...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>NEW-Hard-ICA-Gather-6</td>
      <td>1</td>
      <td>Zero Systems</td>
      <td>DESCRIPTION MISSING</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Data Center Upgrades</td>
      <td>2</td>
      <td>Master Unit</td>
      <td>Turns out our data center was not powerful eno...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"CPU"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>3845.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x3</td>
      <td>Yes x3</td>
      <td>Yes</td>
      <td>No</td>
      <td>Master Unit CPU</td>
    </tr>
    <tr>
      <th>321</th>
      <td>506.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Yes x37</td>
      <td>Yes x6</td>
      <td>Yes</td>
      <td>No</td>
      <td>Zero Systems CPU</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>tasks</code> table has a shortened version of its name so the easiest way to fix this would be to append <code>CPU</code> to the <code>loot</code> name in the <code>tasks</code> table.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Master Unit"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Master Unit CPU'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Master Unit CPU"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6     Master Unit CPU
16    Master Unit CPU
47    Master Unit CPU
11    Master Unit CPU
Name: loot, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another was the <code>Pure Focus Crystals</code> which has the same problem of having the name truncated; this is a trend among all the affected materials with higher tiered materials. Those will all be included in the final correction and will skip showing the process; it's literally just the same and tedious.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Missing the Crystal part</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Pure Focus"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>Geologist</td>
      <td>1</td>
      <td>Pure Focus</td>
      <td>You got time for a job, Prospector? The sample...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Industry Secret</td>
      <td>3</td>
      <td>Pure Focus</td>
      <td>Hm. Interesting. The Pure Focus Crystals you b...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Laser Rifles</td>
      <td>3</td>
      <td>Pure Focus</td>
      <td>We are prototyping a new laser rifle that can ...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Arms Race</td>
      <td>4</td>
      <td>Pure Focus</td>
      <td>Prospector. It seems like Korolev is working o...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Crystal"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>961.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Yes x19</td>
      <td>Yes x10</td>
      <td>Yes</td>
      <td>No</td>
      <td>Focus Crystal</td>
    </tr>
    <tr>
      <th>61</th>
      <td>2883.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x6</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Pure Focus Crystal</td>
    </tr>
    <tr>
      <th>66</th>
      <td>38924.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Yes x6</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Polirium Crystal</td>
    </tr>
    <tr>
      <th>81</th>
      <td>1709.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x36</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Teratomorphic Crystal Core</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This one was a surprise since truncating it doesn't make any sense and gains nothing but the <code>Magnetic Field Stabilizer</code> is being truncated as well.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Missing the Stabilizer:</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Magnetic"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Storm Interference</td>
      <td>2</td>
      <td>Magnetic Field</td>
      <td>Prospector, the Storm has been distorting all ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Surveillance Center</td>
      <td>2</td>
      <td>Magnetic Field</td>
      <td>We want to expand our surveillance operations ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Magnetic"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171</th>
      <td>338.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Yes x71</td>
      <td>Yes x25</td>
      <td>Yes</td>
      <td>No</td>
      <td>Magnetic Field Stabilizer</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lastly, we'll show the <code>NiC Oil</code> which was a problem from the previous post which is missing the <code>Cannister</code> at the end again.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Oil"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>41</th>
      <td>Striking Big</td>
      <td>10</td>
      <td>NiC Oil</td>
      <td>Damn it! We ran out of Fuel for our Radiation ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Oil"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>121</th>
      <td>20183.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x103</td>
      <td>Yes x10</td>
      <td>Yes</td>
      <td>No</td>
      <td>NiC Oil Cannister</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There we go! Now, we'll update the data again and run the merge once more.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Most corrections:</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Master Unit"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Master Unit CPU'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Zero Systems"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Zero Systems CPU'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Pure Focus"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Pure Focus Crystal'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Heavy Mining"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Heavy Mining Tool'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Magnetic Field"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Magnetic Field Stabilizer'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Brittle Titan"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Brittle Titan Ore'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"NiC Oil"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'NiC Oil Cannister'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Charged Spinal"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Charged Spinal Base'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Hardened Bone"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Hardened Bone Plates'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Pale Ivy"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Pale Ivy Blossom'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Glowy Brightcap"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Glowy Brightcap Mushroom'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Blue Runner"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Blue Runner Egg'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Magic"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Magic-GROW Fertilizer'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Letium"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Letium Clot'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Azure Tree"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Azure Tree Bark'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasks</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">taskLoot</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
<span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span> <span class="o">=</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">*</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">allJobs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Rewards == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">taskLoot</span><span class="p">[[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">'Balance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Units'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>13</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've made some good progress so far but we've still got quite a few jobs to update. Let's check the list of missing valuse once more and see if there is a new pattern here.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">results</span><span class="p">[[</span><span class="s1">'Job'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">)</span>
<span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Job</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>Excavation Gear</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>1</td>
      <td>PKR Maelstrom</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Data Drive II</td>
      <td>1</td>
      <td>Rare Data</td>
      <td>The Data you brought us was helpful, but we ne...</td>
      <td>Data Drive II</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Data Drive III</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Good work last time, Prospector. The Data was ...</td>
      <td>Data Drive III</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Data Drive IV</td>
      <td>1</td>
      <td>Epic Data</td>
      <td>In order to be able to predict Storm Behaviour...</td>
      <td>Data Drive IV</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Data Drive V</td>
      <td>1</td>
      <td>Legendary Data</td>
      <td>Yes! The more precise Data you brought us was ...</td>
      <td>Data Drive V</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Data Drive VI</td>
      <td>3</td>
      <td>Legendary Data</td>
      <td>We're finding more than just Storm data now......</td>
      <td>Data Drive VI</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>Grenadier</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>Ammo Supplies</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Data Drop</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Prospector. One of our Scientists is convinced...</td>
      <td>Data Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
      <td>Provide an Advocate</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Backpack</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The biggest standout problem here now is all those data drive quests so lets resolve those next.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Drives:">
<a class="anchor" href="#Data-Drives:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Drives:<a class="anchor-link" href="#Data-Drives:"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have another problem though since none of the tables we have actually contains the data we're after. So, we're back to the wiki to do some more scraping work. If we also look at the names of the data drives we're going to have another problem soon - which you'll see when we download the data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Missing the Data Drive</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Data"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>Data Drive II</td>
      <td>1</td>
      <td>Rare Data</td>
      <td>The Data you brought us was helpful, but we ne...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Data Drive III</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Good work last time, Prospector. The Data was ...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Data Drive IV</td>
      <td>1</td>
      <td>Epic Data</td>
      <td>In order to be able to predict Storm Behaviour...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Data Drive V</td>
      <td>1</td>
      <td>Legendary Data</td>
      <td>Yes! The more precise Data you brought us was ...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Data Drive VI</td>
      <td>3</td>
      <td>Legendary Data</td>
      <td>We're finding more than just Storm data now......</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Data Drop</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Prospector. One of our Scientists is convinced...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like the previous posts, scraping is a tedious process of matching keywords and pulling the right tables so that's getting skipped; it's just mostly trial and error.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">urlDataDrives</span> <span class="o">=</span> <span class="s1">'https://thecyclefrontier.wiki/wiki/Utilities#Data_Drives-0'</span>
<span class="n">siteDrive</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">urlDataDrives</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"zebra"</span><span class="p">})[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use a modified version of the code we wrote before for parsing the <code>loot</code> table for this.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">driveSubset</span> <span class="o">=</span> <span class="n">siteDrive</span><span class="p">[</span>
    <span class="p">[</span><span class="s1">'Image'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">driveSubset</span> <span class="o">=</span> <span class="n">driveSubset</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">Loot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
<span class="p">)</span>

<span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">driveSubset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
    
    <span class="n">aLoot</span> <span class="o">=</span> <span class="n">driveSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">indexes</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">offset</span>
    <span class="n">driveSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">aLoot</span>


<span class="n">tmp</span> <span class="o">=</span> <span class="n">driveSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">"ffill"</span><span class="p">)</span>
<span class="n">driveSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>

<span class="n">cutNA</span> <span class="o">=</span> <span class="n">driveSubset</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">driveData</span> <span class="o">=</span> <span class="n">driveSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">cutNA</span> <span class="p">]</span>
<span class="n">driveData</span> <span class="o">=</span> <span class="n">driveData</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Image'</span><span class="p">:</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">:</span><span class="s1">'Reward'</span><span class="p">})</span>
<span class="n">driveData</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
    <span class="n">driveData</span><span class="o">.</span><span class="n">Rarity</span><span class="p">,</span> <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Common'</span><span class="p">,</span> <span class="s1">'Uncommon'</span><span class="p">,</span> <span class="s1">'Rare'</span><span class="p">,</span> <span class="s1">'Epic'</span><span class="p">,</span> <span class="s1">'Exotic'</span><span class="p">,</span> <span class="s1">'Legendary'</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">driveData</span><span class="p">[</span><span class="s1">'Label'</span><span class="p">]</span> <span class="o">=</span> <span class="n">driveData</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' Data'</span>
<span class="n">drives</span> <span class="o">=</span> <span class="n">driveData</span>

<span class="n">drives</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
      <td>Legendary Data</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since this is the second time that we've needed this - and we're going to need this again - we should write a function to wrap this whole process.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># this is the function, where:</span>
<span class="c1">## siteData: the table from the scraped site</span>
<span class="c1">## columns: the columns you want to keep from the scraped data</span>
<span class="c1">## adjust: the count from the bottom containing an index</span>
<span class="c1">## step: how many rows between values we care about</span>
<span class="c1">## offset: how many rewards are there?</span>
<span class="k">def</span> <span class="nf">extractSite</span><span class="p">(</span><span class="n">siteData</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">adjust</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span>  <span class="n">offset</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Columns argument must be a list."</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">siteSubset</span> <span class="o">=</span> <span class="n">siteData</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">siteSubset</span> <span class="o">=</span> <span class="n">siteSubset</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">Loot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="p">)</span>

    <span class="c1"># Some extra error handling </span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adjust</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"adjust argument must be an int."</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"step argument must be an int."</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"offset argument must be a list."</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">siteSubset</span><span class="p">)</span> <span class="o">-</span> <span class="n">adjust</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
        <span class="n">aLoot</span> <span class="o">=</span> <span class="n">siteSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="n">siteSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">siteSubset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">aLoot</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">siteSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">siteSubset</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">"ffill"</span><span class="p">)</span>
    <span class="n">siteSubset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">siteSubset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>

    <span class="n">cutNA</span> <span class="o">=</span> <span class="n">siteSubset</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">returnData</span> <span class="o">=</span> <span class="n">siteSubset</span><span class="p">[</span> <span class="o">~</span><span class="n">cutNA</span> <span class="p">]</span>
    <span class="n">returnData</span> <span class="o">=</span> <span class="n">returnData</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Image'</span><span class="p">:</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">:</span><span class="s1">'Reward'</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">returnData</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll sanity check this to make sure it works.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drives</span> <span class="o">=</span> <span class="n">extractSite</span><span class="p">(</span><span class="n">siteDrive</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Image'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">drives</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
        <span class="n">drives</span><span class="o">.</span><span class="n">Rarity</span><span class="p">,</span> <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Common'</span><span class="p">,</span> <span class="s1">'Uncommon'</span><span class="p">,</span> <span class="s1">'Rare'</span><span class="p">,</span> <span class="s1">'Epic'</span><span class="p">,</span> <span class="s1">'Exotic'</span><span class="p">,</span> <span class="s1">'Legendary'</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">drives</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Perfect! Now we just add this to our list of adjustments right? Sadly no. If you look at the names of the drives you'll find that we're not quite there. The names of the drives were renamed in <strong>Season 2</strong> but the values in our tasks were not updated from their previous values. This is not too hard to update since the old drive names were just the <code>Rarity</code> + <code>Data</code> and we have that so we'll just need a new column.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drives</span><span class="p">[</span><span class="s1">'Loot'</span><span class="p">]</span> <span class="o">=</span> <span class="n">drives</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' Data'</span>
<span class="n">drives</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Legendary Data</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># drives</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span><span class="s2">"Reward"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">drives</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Reward == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
<p>99 rows Ã— 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Add that to our pipeline and let's see where we are now</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">allJobs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">korolevRewards</span><span class="p">,</span> <span class="n">icaRewards</span><span class="p">,</span> <span class="n">osirisRewards</span><span class="p">])</span>
<span class="n">lootKMarks</span> <span class="o">=</span> <span class="n">loot</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Name == "K-Marks"'</span><span class="p">)</span>

<span class="c1"># Most corrections:</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Master Unit"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Master Unit CPU'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Zero Systems"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Zero Systems CPU'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Pure Focus"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Pure Focus Crystal'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Heavy Mining"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Heavy Mining Tool'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Magnetic Field"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Magnetic Field Stabilizer'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Brittle Titan"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Brittle Titan Ore'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"NiC Oil"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'NiC Oil Cannister'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Charged Spinal"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Charged Spinal Base'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Hardened Bone"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Hardened Bone Plates'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Pale Ivy"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Pale Ivy Blossom'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Glowy Brightcap"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Glowy Brightcap Mushroom'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Blue Runner"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Blue Runner Egg'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Magic"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Magic-GROW Fertilizer'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Letium"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Letium Clot'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loot</span> <span class="o">==</span> <span class="s2">"Azure Tree"</span><span class="p">,</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Azure Tree Bark'</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Extract Stuff here for now:</span>
<span class="n">drives</span> <span class="o">=</span> <span class="n">extractSite</span><span class="p">(</span><span class="n">siteDrive</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Image'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">drives</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
        <span class="n">drives</span><span class="o">.</span><span class="n">Rarity</span><span class="p">,</span> <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Common'</span><span class="p">,</span> <span class="s1">'Uncommon'</span><span class="p">,</span> <span class="s1">'Rare'</span><span class="p">,</span> <span class="s1">'Epic'</span><span class="p">,</span> <span class="s1">'Exotic'</span><span class="p">,</span> <span class="s1">'Legendary'</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">drives</span><span class="p">[</span><span class="s1">'Loot'</span><span class="p">]</span> <span class="o">=</span> <span class="n">drives</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' Data'</span>

<span class="n">lootKMarks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span><span class="s2">"Reward"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">drives</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Reward == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>

<span class="n">taskLoot</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
<span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span> <span class="o">=</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">*</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">allJobs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Rewards == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">taskLoot</span><span class="p">[[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">'Balance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Units'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>7</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's much better! So, what's left to do?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">results</span><span class="p">[[</span><span class="s1">'Job'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">)</span>
<span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Job</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>Excavation Gear</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>1</td>
      <td>PKR Maelstrom</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>Grenadier</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>Ammo Supplies</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
      <td>Provide an Advocate</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Backpack</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Add-the-Guns">
<a class="anchor" href="#Add-the-Guns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add the Guns<a class="anchor-link" href="#Add-the-Guns"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to move to getting the gun data included since we already actualy have it. This was part of another post which was done - not included in the series.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">"https://thecyclefrontier.wiki/wiki/Weapons"</span>
<span class="n">siteGun</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"zebra"</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">gunData</span> <span class="o">=</span> <span class="n">siteGun</span><span class="p">[</span><span class="o">~</span><span class="n">siteGun</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">indx</span> <span class="o">=</span> <span class="n">gunData</span><span class="p">[</span><span class="s1">'Proj. Speed'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Hitscan'</span>
<span class="n">gunData</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indx</span><span class="p">,</span> <span class="s1">'Proj. Speed'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>

<span class="n">gunData</span> <span class="o">=</span> <span class="n">gunData</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">gunData</span><span class="p">[</span><span class="s1">'Sell Value'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' K-Marks'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">),</span>
    <span class="n">Reward</span> <span class="o">=</span> <span class="s2">"K-Marks"</span><span class="p">,</span>
    <span class="n">Loot</span> <span class="o">=</span> <span class="n">gunData</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># # This removes the legendary weapons</span>
<span class="c1"># data = data.query('Faction != "Printing"')</span>

<span class="n">guns</span> <span class="o">=</span> <span class="n">gunData</span>
<span class="n">guns</span><span class="p">[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17429.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Advocate</td>
    </tr>
    <tr>
      <th>3</th>
      <td>524.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>AR-55 Autorifle</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12341.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Asp Flechette Gun</td>
    </tr>
    <tr>
      <th>9</th>
      <td>371.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>B9 Trenchgun</td>
    </tr>
    <tr>
      <th>12</th>
      <td>63080.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Basilisk</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1918.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Bulldog</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2052.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>C-32 Bolt Action</td>
    </tr>
    <tr>
      <th>21</th>
      <td>17429.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Gorgon</td>
    </tr>
    <tr>
      <th>24</th>
      <td>16805.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Hammer</td>
    </tr>
    <tr>
      <th>27</th>
      <td>7143.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>ICA Guarantee</td>
    </tr>
    <tr>
      <th>30</th>
      <td>228.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>K-28</td>
    </tr>
    <tr>
      <th>33</th>
      <td>325513.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>KARMA-1</td>
    </tr>
    <tr>
      <th>36</th>
      <td>22781.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>KBR Longshot</td>
    </tr>
    <tr>
      <th>39</th>
      <td>94459.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Kinetic Arbiter</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1918.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>KM-9 'Scrapper'</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we have the gun data to be added to the <code>loot</code> table but if you were paying attention you may have noticed something is wrong with one of our values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Not sure what this is from.</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">' at'</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Advocate in this row is labeled as <code>Advocate at</code> which is another problem. In this instance, instead of trying to deal with the regex we're just going to update that single value.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'Advocate at'</span><span class="p">),</span> <span class="s1">'loot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Advocate'</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tasks</span><span class="o">.</span><span class="n">loot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'Advocate'</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate</td>
      <td>Our field agent requested better gear to take ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And, make sure that the append works as intended:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">lootKMarks</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span><span class="s2">"Reward"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">drives</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Reward == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">guns</span><span class="p">[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]]]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>63</th>
      <td>371.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>S-576 PDW</td>
    </tr>
    <tr>
      <th>66</th>
      <td>1179.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Scarab</td>
    </tr>
    <tr>
      <th>69</th>
      <td>12341.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Shattergun</td>
    </tr>
    <tr>
      <th>72</th>
      <td>34172.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Voltaic Brute</td>
    </tr>
    <tr>
      <th>75</th>
      <td>270540.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Zeus Beam</td>
    </tr>
  </tbody>
</table>
<p>125 rows Ã— 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deal-With-Backpacks">
<a class="anchor" href="#Deal-With-Backpacks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deal With Backpacks<a class="anchor-link" href="#Deal-With-Backpacks"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to try to fix the Backpacks, the Shields and the Helmets toegther since they're all on the same page of the wiki. Again, this data was not part of the previous tables that we had so we'll need to go get it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gearUrl</span> <span class="o">=</span> <span class="s1">'https://thecyclefrontier.wiki/wiki/Gear'</span>
<span class="n">site</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">gearUrl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This was tricky to collect - which is only why I'm pointing out how it was done. While working out how to collect the data from the website, there was no good strategy to collect just the data that I wanted. What you will see is that I use hard coded values to pull out where each table is.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">siteBackPacks</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">siteHelmet</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">siteShield</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What I did was <code>enumerate</code> throught all the tables collected to find which results had outlier sizes. I then pulled those to make sure they were what I was after like this:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 10</span>
<span class="c1"># 22</span>
<span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">site</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(0, 22),
 (1, 1),
 (2, 1),
 (3, 3),
 (4, 1),
 (5, 4),
 (6, 1),
 (7, 4),
 (8, 1),
 (9, 1),
 (10, 46),
 (11, 1),
 (12, 1),
 (13, 3),
 (14, 4),
 (15, 4),
 (16, 3),
 (17, 4),
 (18, 4),
 (19, 3),
 (20, 4),
 (21, 4),
 (22, 43),
 (23, 1),
 (24, 1),
 (25, 3),
 (26, 4),
 (27, 4),
 (28, 4),
 (29, 4),
 (30, 4),
 (31, 4),
 (32, 4)]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is not pretty but web scraping rarely is. And, it works. Next we'll start with the backup packs; with some tweaking of the values to the <code>extractSite</code> function which was defined earlier, this becomes really easy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backpacks</span> <span class="o">=</span> <span class="n">extractSite</span><span class="p">(</span>
    <span class="n">siteData</span> <span class="o">=</span> <span class="n">siteBackPacks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">siteBackPacks</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Backpack|K-Marks"</span><span class="p">)],</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Image'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Space'</span><span class="p">,</span> <span class="s1">'Sale Price'</span><span class="p">],</span>
    <span class="n">adjust</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> 
    <span class="n">step</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">backpacks</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Space</th>
      <th>Sale Price</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>600.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>200.0</td>
      <td>180  K-Marks</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>2</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>200.0</td>
      <td>180  K-Marks</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2700.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>250.0</td>
      <td>810  K-Marks</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>250.0</td>
      <td>810  K-Marks</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6100.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>300.0</td>
      <td>1,830  K-Marks</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>300.0</td>
      <td>1,830  K-Marks</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>12000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>350.0</td>
      <td>4,000  K-Marks</td>
      <td>Heavy Duty Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>350.0</td>
      <td>4,000  K-Marks</td>
      <td>Heavy Duty Backpack</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at these results though, what we're really after is the <code>Sale Price</code> and so we'll need to move some stuff around.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backpacks</span> <span class="o">=</span> <span class="n">backpacks</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">backpacks</span><span class="p">[</span><span class="s1">'Sale Price'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' K-Marks'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">backpacks</span> <span class="o">=</span> <span class="n">backpacks</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"Sale Price"</span><span class="p">,</span> <span class="s2">"Space"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">backpacks</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>2</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>4</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Heavy Duty Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Heavy Duty Backpack</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have the same problem which we had for the Data Drives: the the old name <code>Rare Backpack</code> is in the <code>tasks</code> table but is not how they are named here. Again, we're just going to steal and modify the solution we had before and apply it here.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backpacks</span><span class="p">[</span><span class="s1">'Loot'</span><span class="p">]</span> <span class="o">=</span> <span class="n">backpacks</span><span class="p">[</span><span class="s1">'Rarity'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' Backpack'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Time to add them to the pipeline.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">lootKMarks</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span><span class="s2">"Reward"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">drives</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Reward == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">guns</span><span class="p">[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">backpacks</span>
<span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Uncommon Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Backpack</td>
    </tr>
  </tbody>
</table>
<p>133 rows Ã— 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is much better. So, how many are missing now?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much better. But, there is actually a new problem here: <strong>masking missing values</strong>. If we look back at our data from before we'll see that there was Helment and Shield information missing and now it's gone! Since we've fixed some of the values for those jobs the <code>Balance</code> is no longer <code>0</code> and thefore we've lost track of it! Let's step back and look at the merged result and look for mistakes. And, upon doing this we run into our first masked problem.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
<span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New Mining Tools</td>
      <td>2.0</td>
      <td>Hydraulic Piston</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Excavator Improvements</td>
      <td>3.0</td>
      <td>Hydraulic Piston</td>
      <td>The suspension on our mining excavators need i...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New Mining Tools</td>
      <td>10.0</td>
      <td>Hardened Metals</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Automated Security</td>
      <td>16.0</td>
      <td>Hardened Metals</td>
      <td>We will have to build new turrets to help prot...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Air Lock Upgrades</td>
      <td>12.0</td>
      <td>Hardened Metals</td>
      <td>Our engineers designed a safer airlock system ...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>211</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Common Backpack</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uncommon Backpack</td>
      <td>810.0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uncommon Backpack</td>
      <td>810.0</td>
    </tr>
    <tr>
      <th>214</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Epic Backpack</td>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>215</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Epic Backpack</td>
      <td>4000.0</td>
    </tr>
  </tbody>
</table>
<p>216 rows Ã— 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are all these <code>NaN</code> values at the bottom which were attached and included due to the <code>outer</code> including all the rows. Can we simply change this over to a <code>left</code>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is more in line what I'd have expected. We'll temporarily keep this - but mostly for discussion purposes. The problem here is that when you look through the wiki there are no sell values for the Shields and Helmets. We cannot get these from the wiki which means we cannot automate it. We could do this manually but then I'd have to constantly update this value when it changes - which I'm trying to avoid. This looks to be a case where we're going to need to remove this job for now.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Adding this to the pipeline:</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Loadout Drop"</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]</span>
<span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New Mining Tools</td>
      <td>2</td>
      <td>Hydraulic Piston</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New Mining Tools</td>
      <td>10</td>
      <td>Hardened Metals</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Explosive Excavation</td>
      <td>4</td>
      <td>Derelict Explosives</td>
      <td>One of our mines collapsed with valuable equip...</td>
      <td>Derelict Explosives</td>
      <td>1709.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mining Bot</td>
      <td>2</td>
      <td>Zero Systems CPU</td>
      <td>Our engineers have designed an autonomous mini...</td>
      <td>Zero Systems CPU</td>
      <td>506.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mining Bot</td>
      <td>3</td>
      <td>Ball Bearings</td>
      <td>Our engineers have designed an autonomous mini...</td>
      <td>Ball Bearings</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Flexible Sealant</td>
      <td>8</td>
      <td>Resin Gun</td>
      <td>A number of our weather balloons took damage f...</td>
      <td>Resin Gun</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>Indigenous Fruit</td>
      <td>4</td>
      <td>Indigenous Fruit</td>
      <td>Ah, Prospector, have you come across any Indig...</td>
      <td>Indigenous Fruit</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>Indigenous Fruit</td>
      <td>4</td>
      <td>Biological Sampler</td>
      <td>Ah, Prospector, have you come across any Indig...</td>
      <td>Biological Sampler</td>
      <td>1139.0</td>
    </tr>
    <tr>
      <th>140</th>
      <td>Don't get crushed</td>
      <td>3</td>
      <td>Crusher Hide</td>
      <td>Gear up, Prospector! We need Crusher Skins for...</td>
      <td>Crusher Hide</td>
      <td>11533.0</td>
    </tr>
  </tbody>
</table>
<p>137 rows Ã— 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, so it looks like next will be solving the ammo listings.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deal-with-Ammo">
<a class="anchor" href="#Deal-with-Ammo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deal with Ammo<a class="anchor-link" href="#Deal-with-Ammo"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ammoUrl</span> <span class="o">=</span> <span class="s2">"https://thecyclefrontier.wiki/wiki/Ammo"</span>
<span class="n">ammo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">ammoUrl</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've already done this before so this is simply here to show it was done. And, you add it to the pipeline just the same.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ammo</span> <span class="o">=</span> <span class="n">ammo</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">"Item Name"</span><span class="p">:</span><span class="s2">"Loot"</span><span class="p">,</span> <span class="s2">"Sell Value"</span><span class="p">:</span><span class="s2">"Unit"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">Reward</span> <span class="o">=</span> <span class="s2">"K-Marks"</span><span class="p">,</span>
        <span class="n">Rarity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
            <span class="n">ammo</span><span class="o">.</span><span class="n">Rarity</span><span class="p">,</span> <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Common'</span><span class="p">,</span> <span class="s1">'Uncommon'</span><span class="p">,</span> <span class="s1">'Rare'</span><span class="p">,</span> <span class="s1">'Epic'</span><span class="p">,</span> <span class="s1">'Exotic'</span><span class="p">,</span> <span class="s1">'Legendary'</span><span class="p">])</span>
    <span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deal-with-The-Heavy-Mining-Tool">
<a class="anchor" href="#Deal-with-The-Heavy-Mining-Tool" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deal with The Heavy Mining Tool<a class="anchor-link" href="#Deal-with-The-Heavy-Mining-Tool"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sadly, this tool is on its own page so we'll need something custom again. There is a table here we can pull but it's oriented incorrectly for our use.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">site</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s2">"https://thecyclefrontier.wiki/wiki/Heavy_Mining_Tool"</span><span class="p">)</span>
<span class="n">minerData</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">minerData</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Description</td>
      <td>Allows faster mining of materials.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Rarity</td>
      <td>Common</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Weight</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Buy Value</td>
      <td>600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sell Value</td>
      <td>180</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Faction Points</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thankfully, a data frame has the <strong>Transpose</strong> function that a matrix does. A simple explanation of this function is that it swaps the rows to columns and columns to rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minerData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0       Description
1            Rarity
2            Weight
3         Buy Value
4        Sell Value
5    Faction Points
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to extract the rows values to create a new dataframe object. Since the <code>Heaving Mining Tool</code> designation is missing from the data then we'll need to add it ourself.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="n">minerData</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'Heavy Mining Tool'</span><span class="p">]</span>
<span class="n">row</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['Allows faster mining of materials.',
 'Common',
 '30',
 '600',
 '180',
 '2',
 'Heavy Mining Tool']</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="n">minerData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'Loot'</span><span class="p">]</span>
<span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['Description',
 'Rarity',
 'Weight',
 'Buy Value',
 'Sell Value',
 'Faction Points',
 'Loot']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And, join them together.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mineTool</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<span class="n">mineTool</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
<span class="n">mineTool</span> <span class="o">=</span> <span class="n">mineTool</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">Reward</span> <span class="o">=</span> <span class="s2">"K-Marks"</span><span class="p">,</span>
    <span class="n">Rarity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
        <span class="n">mineTool</span><span class="o">.</span><span class="n">Rarity</span><span class="p">,</span> <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Common'</span><span class="p">,</span> <span class="s1">'Uncommon'</span><span class="p">,</span> <span class="s1">'Rare'</span><span class="p">,</span> <span class="s1">'Epic'</span><span class="p">,</span> <span class="s1">'Exotic'</span><span class="p">,</span> <span class="s1">'Legendary'</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineTool</span><span class="p">[</span><span class="s1">'Sell Value'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
<span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]]</span>
<span class="n">mineTool</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>180</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Heavy Mining Tool</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And, add it to the pipeline.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lootKMarks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">lootKMarks</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span><span class="s2">"Reward"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">drives</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Reward == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">guns</span><span class="p">[[</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Reward'</span><span class="p">,</span> <span class="s1">'Rarity'</span><span class="p">,</span> <span class="s1">'Loot'</span><span class="p">]],</span>
    <span class="n">backpacks</span><span class="p">,</span>
    <span class="n">ammo</span><span class="p">,</span>
    <span class="n">mineTool</span>
<span class="p">])</span>

<span class="c1"># Drop this quest</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Loadout Drop"</span><span class="p">)</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]</span>

<span class="n">taskLoot</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
<span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span> <span class="o">=</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">*</span> <span class="n">taskLoot</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">allJobs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'Rewards == "K-Marks"'</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">taskLoot</span><span class="p">[[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'Cost'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"Job"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">'Balance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Units'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">'Cost'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Cost == 0"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>77</th>
      <td>2400</td>
      <td>K-Marks</td>
      <td>Grenadier</td>
      <td>0.0</td>
      <td>2400.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>155000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
      <td>155000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lootKMarks</span><span class="p">[[</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'loot'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Loot'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">Loot</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>151</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusions">
<a class="anchor" href="#Conclusions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusions<a class="anchor-link" href="#Conclusions"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the best we'll get I suppose. Now, back to our check: How bad is our good old job <code>And two smoking Barrels</code>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">Job</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Barrel"</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>19000</td>
      <td>K-Marks</td>
      <td>And two smoking Barrels</td>
      <td>40716.0</td>
      <td>-21716.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And, there we go! So, how many jobs have a negative balance?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"Balance &lt; 0 "</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>19000</td>
      <td>K-Marks</td>
      <td>And two smoking Barrels</td>
      <td>40716.0</td>
      <td>-21716.0</td>
    </tr>
    <tr>
      <th>70</th>
      <td>9500</td>
      <td>K-Marks</td>
      <td>Data Drive III</td>
      <td>10124.0</td>
      <td>-624.0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>56000</td>
      <td>K-Marks</td>
      <td>Data Drive VI</td>
      <td>61512.0</td>
      <td>-5512.0</td>
    </tr>
    <tr>
      <th>81</th>
      <td>17000</td>
      <td>K-Marks</td>
      <td>Ammo Supplies</td>
      <td>69000.0</td>
      <td>-52000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's not as bad as I expected. What is the average job balance?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">results</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(13300.702127659575, 11256.0)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, what jobs are above the mean?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Balance &gt;= </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Excavator Improvements</td>
      <td>4306.0</td>
      <td>20694.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>A new type of Alloy</td>
      <td>15468.0</td>
      <td>21532.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Automated Security</td>
      <td>4930.0</td>
      <td>22070.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>52000</td>
      <td>K-Marks</td>
      <td>Classified I</td>
      <td>27030.0</td>
      <td>24970.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Geologist</td>
      <td>6727.0</td>
      <td>20273.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>29000</td>
      <td>K-Marks</td>
      <td>Industry Secret</td>
      <td>8649.0</td>
      <td>20351.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>34000</td>
      <td>K-Marks</td>
      <td>Veltecite Hearts</td>
      <td>12974.0</td>
      <td>21026.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>40000</td>
      <td>K-Marks</td>
      <td>Laser Rifles</td>
      <td>18259.0</td>
      <td>21741.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>47000</td>
      <td>K-Marks</td>
      <td>Classified II</td>
      <td>23922.0</td>
      <td>23078.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>41000</td>
      <td>K-Marks</td>
      <td>Unlimited Power</td>
      <td>17377.0</td>
      <td>23623.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Meteor Core</td>
      <td>7594.0</td>
      <td>19406.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Shards of pure Power</td>
      <td>8104.0</td>
      <td>21896.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>48000</td>
      <td>K-Marks</td>
      <td>Battery Day</td>
      <td>22782.0</td>
      <td>25218.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>28000</td>
      <td>K-Marks</td>
      <td>Upgrades</td>
      <td>3845.0</td>
      <td>24155.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>140000</td>
      <td>K-Marks</td>
      <td>Exclusive Drilling Rights</td>
      <td>115330.0</td>
      <td>24670.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>32000</td>
      <td>K-Marks</td>
      <td>Stocking Up</td>
      <td>9120.0</td>
      <td>22880.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Shock and Awe</td>
      <td>11385.0</td>
      <td>14615.0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>Sabotage</td>
      <td>15696.0</td>
      <td>21304.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>28000</td>
      <td>K-Marks</td>
      <td>Old Currency</td>
      <td>6000.0</td>
      <td>22000.0</td>
    </tr>
    <tr>
      <th>52</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Recoil Compensation</td>
      <td>9390.0</td>
      <td>16610.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>45000</td>
      <td>K-Marks</td>
      <td>New 3D Printer</td>
      <td>21362.0</td>
      <td>23638.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>Arms Race</td>
      <td>11532.0</td>
      <td>21468.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>35000</td>
      <td>K-Marks</td>
      <td>Energy Crisis</td>
      <td>18984.0</td>
      <td>16016.0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Data Drive IV</td>
      <td>12150.0</td>
      <td>13850.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>A Solution</td>
      <td>10125.0</td>
      <td>22875.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Data Drop</td>
      <td>10124.0</td>
      <td>14876.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Field Supplies</td>
      <td>3000.0</td>
      <td>23000.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Spare Parts</td>
      <td>2024.0</td>
      <td>22976.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>29000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-ICA-Gather-6</td>
      <td>9142.0</td>
      <td>19858.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>227000</td>
      <td>K-Marks</td>
      <td>Striking Big</td>
      <td>201830.0</td>
      <td>25170.0</td>
    </tr>
    <tr>
      <th>93</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>A Craving</td>
      <td>4048.0</td>
      <td>20952.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Cretins</td>
      <td>6300.0</td>
      <td>19700.0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Sensor Array Repairs</td>
      <td>6908.0</td>
      <td>20092.0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>32000</td>
      <td>K-Marks</td>
      <td>A new Energy Source</td>
      <td>11289.0</td>
      <td>20711.0</td>
    </tr>
    <tr>
      <th>100</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Data Center Upgrades</td>
      <td>7690.0</td>
      <td>22310.0</td>
    </tr>
    <tr>
      <th>101</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Keep the Experiment running</td>
      <td>7200.0</td>
      <td>22800.0</td>
    </tr>
    <tr>
      <th>102</th>
      <td>61000</td>
      <td>K-Marks</td>
      <td>Safety Measures</td>
      <td>36309.0</td>
      <td>24691.0</td>
    </tr>
    <tr>
      <th>122</th>
      <td>31000</td>
      <td>K-Marks</td>
      <td>Harvest Day</td>
      <td>6583.0</td>
      <td>24417.0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>Core Values</td>
      <td>15188.0</td>
      <td>21812.0</td>
    </tr>
    <tr>
      <th>126</th>
      <td>45000</td>
      <td>K-Marks</td>
      <td>Promising Results</td>
      <td>21266.0</td>
      <td>23734.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>24000</td>
      <td>K-Marks</td>
      <td>Stormy Samples</td>
      <td>2700.0</td>
      <td>21300.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Stormy Samples II</td>
      <td>2024.0</td>
      <td>22976.0</td>
    </tr>
    <tr>
      <th>132</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>Loadout Drop</td>
      <td>7320.0</td>
      <td>25680.0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-Gather-7</td>
      <td>12816.0</td>
      <td>20184.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>155000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
      <td>155000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Perfect! Next we'll loop back around to automating the pipeline and uploading the data to Kaggle.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/game/python/data/science/exploration/cycle/frontier/2022/10/21/cycle-jobs-part-four.html" hidden></a>
</article>
      </div>
    </main></body>

</html>
