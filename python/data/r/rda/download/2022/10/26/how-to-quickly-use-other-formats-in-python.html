<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Collecting External Data for Python. | Orgulo.us</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Collecting External Data for Python." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Or, Delete the Intermediate When Collecting Data." />
<meta property="og:description" content="Or, Delete the Intermediate When Collecting Data." />
<link rel="canonical" href="https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html" />
<meta property="og:url" content="https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html" />
<meta property="og:site_name" content="Orgulo.us" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-26T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"Collecting External Data for Python.","dateModified":"2022-10-26T00:00:00-05:00","datePublished":"2022-10-26T00:00:00-05:00","description":"Or, Delete the Intermediate When Collecting Data.","mainEntityOfPage":{"@type":"WebPage","@id":"https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html"},"@type":"BlogPosting","url":"https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://orgulo.us/feed.xml" title="Orgulo.us" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Collecting External Data for Python. | Orgulo.us</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Collecting External Data for Python." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Or, Delete the Intermediate When Collecting Data." />
<meta property="og:description" content="Or, Delete the Intermediate When Collecting Data." />
<link rel="canonical" href="https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html" />
<meta property="og:url" content="https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html" />
<meta property="og:site_name" content="Orgulo.us" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-26T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"Collecting External Data for Python.","dateModified":"2022-10-26T00:00:00-05:00","datePublished":"2022-10-26T00:00:00-05:00","description":"Or, Delete the Intermediate When Collecting Data.","mainEntityOfPage":{"@type":"WebPage","@id":"https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html"},"@type":"BlogPosting","url":"https://orgulo.us/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://orgulo.us/feed.xml" title="Orgulo.us" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Orgulo.us</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Readings/">Reading Challenge</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Collecting External Data for Python.</h1><p class="page-description">Or, Delete the Intermediate When Collecting Data.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-26T00:00:00-05:00" itemprop="datePublished">
        Oct 26, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#data">data</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#r">r</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#rda">rda</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#download">download</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-26-how-to-quickly-use-other-formats-in-python.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While preparing for some upcoming blog posts taking material from <strong>Design and Analysis of Experiments With R</strong> by <em>John Lawson</em>, I wanted to convert the problems and solutions from <code>R</code> code to <code>Python</code> code. Diong this will require using the real data and - luckily - the data from the book is online on <a href="https://github.com/cran/daewr">Github</a>. Due to how these packages are, the <a href="https://github.com/cran/daewr/tree/master/data">data</a> is uploaded and kept as binary data which we can use. Unfortunately, the data is in the <code>.rda</code> format which doesn't convert easily into python.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is a package for this to convert the data: <code>pyreadr</code>. Which we're doing to use to convert the data into a dataframe Python understands. Sadly, this package doesn't handle urls so we'll need to download the data first. We could clone out the whole repository to collect the data but then we'd have to start manually managing the data - which I don't want to do.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After a bit of working around, we can use the <code>tempfile</code> builtin package from Python to create a temporary file to dump the data into. This is useful since these will be deleted after it's <code>.close()</code> is called on the file. But, we'll want a Named version since we want this accessible to the file system:</p>
<blockquote><p>This function operates exactly as TemporaryFile() does, except that the file is guaranteed to have a visible name in the file system (on Unix, the directory entry is not unlinked). That name can be retrieved from the name attribute of the returned file-like object. Whether the name can be used to open the file a second time, while the named temporary file is still open, varies across platforms (it can be so used on Unix; it cannot on Windows).</p>
</blockquote>
<p><a href="https://docs.python.org/3/library/tempfile.html#tempfile.NamedTemporaryFile">Source</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the <code>requests</code> library to pull the data from the internet since it's builtin and easy to use.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip install pyreadr</span>
<span class="kn">import</span> <span class="nn">pyreadr</span> <span class="k">as</span> <span class="nn">pyr</span>
<span class="kn">import</span> <span class="nn">tempfile</span> <span class="k">as</span> <span class="nn">tmp</span>
<span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">r</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One caveat here is that you'll need to rewind the read location in the file to read the temporary file otherwise you'll get an <strong>LibrdataError: Unable to read from file</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tmp</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">something</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://github.com/cran/daewr/raw/master/data/Apo.rda&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pyr</span><span class="o">.</span><span class="n">read_r</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="s1">&#39;Apo&#39;</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>lab</th>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
    </tr>
    <tr>
      <th>conc</th>
      <td>1.195</td>
      <td>1.144</td>
      <td>1.167</td>
      <td>1.249</td>
      <td>1.177</td>
      <td>1.217</td>
      <td>1.187</td>
      <td>1.155</td>
      <td>1.173</td>
      <td>1.171</td>
      <td>1.175</td>
      <td>1.153</td>
      <td>1.139</td>
      <td>1.185</td>
      <td>1.144</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There we go! You can use this as a simple way to collect data from the internet and feed it into a package which doesn't support urls to read in data. You can expect its usage in the near future while I work through the textbook.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/python/data/r/rda/download/2022/10/26/how-to-quickly-use-other-formats-in-python.html" hidden></a>
</article>
      </div>
    </main></body>

</html>
